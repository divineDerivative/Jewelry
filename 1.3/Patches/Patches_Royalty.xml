<?xml version="1.0" encoding="utf-8"?>
<Patch>

  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Royalty</li>
    </mods>
    <match Class="PatchOperationSequence">
      <operations>
        <!-- Add eltex jewelry -->
        <li Class="PatchOperationAdd">
          <xpath>/Defs</xpath>
          <value>
            <ThingDef ParentName="K_Necklace">
              <defName>Jewelry_PsychicNecklace_Silver</defName>
              <label>silver eltex necklace</label>
              <description>A beautiful necklace made from silver and a priceless gem. It improves the wearer's social skill and beauty. This particular necklace is for psychic focusing. While it provides little physical protection, its special materials enhance the wearer's psychic sensitivity and dissipate psychic entropy.</description>
              <graphicData>
                <texPath>SilverJewelery/JewelleryNecklace</texPath>
                <graphicClass>Graphic_Single</graphicClass>
                <shaderType>CutoutComplex</shaderType>
              </graphicData>
              <statBases>
                <Mass>0.14</Mass>
                <EquipDelay>0.3</EquipDelay>
                <MarketValue>450</MarketValue>
                <Beauty>10</Beauty>
                <WorkToMake>4000</WorkToMake>
              </statBases>
              <equippedStatOffsets>
                <PsychicEntropyRecoveryRate>0.05</PsychicEntropyRecoveryRate>
                <PsychicSensitivity>0.10</PsychicSensitivity>
                <PawnBeauty>+1</PawnBeauty>
                <SocialImpact>0.1</SocialImpact>
              </equippedStatOffsets>
              <techLevel>Ultra</techLevel>
              <tradeTags>
                <li>PsychicApparel</li>
              </tradeTags>
              <thingSetMakerTags>
                <li>RewardStandardLowFreq</li>
              </thingSetMakerTags>
              <apparel>
                <tags>
                  <li>Psychic</li>
                </tags>
              </apparel>
              <costStuffCount>15</costStuffCount>
              <stuffCategories>
                <li>Gemstones</li>
              </stuffCategories>
              <costList>
                <Silver>3</Silver>
              </costList>
            </ThingDef>
          </value>
        </li>
        <li Class="PatchOperationAdd">
          <xpath>/Defs</xpath>
          <value>
            <ThingDef ParentName="K_Necklace">
              <defName>Jewelry_PsychicNecklace</defName>
              <label>gold eltex necklace</label>
              <description>A beautiful necklace made from gold and a priceless gem. It improves the wearer's social skill and beauty. This particular necklace is for psychic focusing. While it provides little physical protection, its special materials enhance the wearer's psychic sensitivity and dissipate psychic entropy.</description>
              <graphicData>
                <texPath>Items/Apparel/Necklace/JewelleryNecklace</texPath>
                <graphicClass>Graphic_Single</graphicClass>
                <shaderType>CutoutComplex</shaderType>
              </graphicData>
              <statBases>
                <Mass>0.14</Mass>
                <EquipDelay>0.3</EquipDelay>
                <MarketValue>450</MarketValue>
                <Beauty>10</Beauty>
                <WorkToMake>4000</WorkToMake>
              </statBases>
              <equippedStatOffsets>
                <PsychicEntropyRecoveryRate>0.05</PsychicEntropyRecoveryRate>
                <PsychicSensitivity>0.10</PsychicSensitivity>
                <PawnBeauty>+1</PawnBeauty>
                <SocialImpact>0.1</SocialImpact>
              </equippedStatOffsets>
              <techLevel>Ultra</techLevel>
              <tradeTags>
                <li>PsychicApparel</li>
              </tradeTags>
              <thingSetMakerTags>
                <li>RewardStandardLowFreq</li>
              </thingSetMakerTags>
              <apparel>
                <tags>
                  <li>Psychic</li>
                </tags>
              </apparel>
              <costStuffCount>15</costStuffCount>
              <stuffCategories>
                <li>Gemstones</li>
              </stuffCategories>
              <costList>
                <Gold>3</Gold>
              </costList>
            </ThingDef>
          </value>
        </li>
        <!-- Add Gemstone to authorized stuff for empire faction -->
        <li Class="PatchOperationAdd">
          <xpath>Defs/FactionDef[defName="Empire"]/apparelStuffFilter/stuffCategoriesToAllow</xpath>
          <value>
            <li>Gemstones</li>
          </value>
        </li>
        <!-- Add jewelry to required apparel -->
        <li Class="PatchOperationAdd">
          <xpath>Defs/RoyalTitleDef[defName="Esquire" or defName="Knight"]/requiredApparel</xpath>
          <value>
            <li>
              <bodyPartGroupsMatchAny>
                <li>LeftHand</li>
              </bodyPartGroupsMatchAny>
              <requiredTags>
                <li>Jewelry</li>
              </requiredTags>
              <allowedTags>
                <li>Jewelry</li>
              </allowedTags>
            </li>
            <li>
              <bodyPartGroupsMatchAny>
                <li>Ears</li>
              </bodyPartGroupsMatchAny>
              <requiredTags>
                <li>Jewelry</li>
              </requiredTags>
              <allowedTags>
                <li>Jewelry</li>
              </allowedTags>
            </li>
          </value>
        </li>
        <!-- Add jewelry to pawnkind -->
        <li Class="PatchOperationAdd">
          <xpath>Defs/PawnKindDef[defName="Empire_Royal_Esquire" or defName="Empire_Royal_Knight"]</xpath>
          <value>
            <apparelRequired>
              <li>Jewelry_Bracelet</li>
              <li>Jewelry_Earring</li>
            </apparelRequired>
          </value>
        </li>
        <!-- Add jewelry to required apparel -->
        <li Class="PatchOperationAdd">
          <xpath>Defs/RoyalTitleDef[defName="Praetor" or defName="Baron"]/requiredApparel</xpath>
          <value>
            <li>
              <bodyPartGroupsMatchAny>
                <li>RightHand</li>
              </bodyPartGroupsMatchAny>
              <requiredTags>
                <li>Jewelry</li>
              </requiredTags>
              <allowedTags>
                <li>Jewelry</li>
              </allowedTags>
            </li>
            <li>
              <bodyPartGroupsMatchAny>
                <li>LeftHand</li>
              </bodyPartGroupsMatchAny>
              <requiredTags>
                <li>Jewelry</li>
              </requiredTags>
              <allowedTags>
                <li>Jewelry</li>
              </allowedTags>
            </li>
            <li>
              <bodyPartGroupsMatchAny>
                <li>Ears</li>
              </bodyPartGroupsMatchAny>
              <requiredTags>
                <li>Jewelry</li>
              </requiredTags>
              <allowedTags>
                <li>Jewelry</li>
              </allowedTags>
            </li>
          </value>
        </li>
        <!-- Add jewelry to pawnkind -->
        <li Class="PatchOperationAdd">
          <xpath>Defs/PawnKindDef[defName="Empire_Royal_Praetor" or defName="Empire_Royal_Baron"]</xpath>
          <value>
            <apparelRequired>
              <li>Jewelry_Bracelet</li>
              <li>Jewelry_Ring</li>
              <li>Jewelry_Earring</li>
            </apparelRequired>
          </value>
        </li>
        <!-- Add jewelry to required apparel -->
        <li Class="PatchOperationAdd">
          <xpath>Defs/RoyalTitleDef[defName="Count"]/requiredApparel</xpath>
          <value>
            <li>
              <bodyPartGroupsMatchAny>
                <li>RightHand</li>
              </bodyPartGroupsMatchAny>
              <requiredTags>
                <li>Jewelry</li>
              </requiredTags>
              <allowedTags>
                <li>Jewelry</li>
              </allowedTags>
            </li>
            <li>
              <bodyPartGroupsMatchAny>
                <li>LeftHand</li>
              </bodyPartGroupsMatchAny>
              <requiredTags>
                <li>Jewelry</li>
              </requiredTags>
              <allowedTags>
                <li>Jewelry</li>
              </allowedTags>
            </li>
            <li>
              <bodyPartGroupsMatchAny>
                <li>Ears</li>
              </bodyPartGroupsMatchAny>
              <requiredTags>
                <li>Jewelry</li>
              </requiredTags>
              <allowedTags>
                <li>Jewelry</li>
              </allowedTags>
            </li>
            <li>
              <bodyPartGroupsMatchAny>
                <li>Neck</li>
              </bodyPartGroupsMatchAny>
              <requiredTags>
                <li>Jewelry</li>
              </requiredTags>
              <allowedTags>
                <li>Jewelry</li>
              </allowedTags>
            </li>
          </value>
        </li>
        <!-- Add jewelry to pawnkind -->
        <li Class="PatchOperationAdd">
          <xpath>Defs/PawnKindDef[defName="Empire_Royal_Count" or defName="Empire_Royal_Duke" or defName="Empire_Royal_Consul" or defName="Empire_Royal_Stellarch"]</xpath>
          <value>
            <apparelRequired>
              <li>Jewelry_Bracelet</li>
              <li>Jewelry_Ring</li>
              <li>Jewelry_Earring</li>
              <li>Jewelry_Necklace</li>
            </apparelRequired>
          </value>
        </li>
        <!-- Add jewelry to required apparel npc -->
        <li Class="PatchOperationAdd">
          <xpath>Defs/RoyalTitleDef[@Name="BaseEmpireTitleNPC"]/requiredApparel</xpath>
          <value>
            <li>
              <bodyPartGroupsMatchAny>
                <li>RightHand</li>
              </bodyPartGroupsMatchAny>
              <requiredTags>
                <li>Jewelry</li>
              </requiredTags>
              <allowedTags>
                <li>Jewelry</li>
              </allowedTags>
            </li>
            <li>
              <bodyPartGroupsMatchAny>
                <li>LeftHand</li>
              </bodyPartGroupsMatchAny>
              <requiredTags>
                <li>Jewelry</li>
              </requiredTags>
              <allowedTags>
                <li>Jewelry</li>
              </allowedTags>
            </li>
            <li>
              <bodyPartGroupsMatchAny>
                <li>Ears</li>
              </bodyPartGroupsMatchAny>
              <requiredTags>
                <li>Jewelry</li>
              </requiredTags>
              <allowedTags>
                <li>Jewelry</li>
              </allowedTags>
            </li>
            <li>
              <bodyPartGroupsMatchAny>
                <li>Neck</li>
              </bodyPartGroupsMatchAny>
              <requiredTags>
                <li>Jewelry</li>
              </requiredTags>
              <allowedTags>
                <li>Jewelry</li>
              </allowedTags>
            </li>
          </value>
        </li>
        <!-- More apparel money for royal -->
        <li Class="PatchOperationReplace">
          <success>Always</success>
          <xpath>Defs/PawnKindDef[@Name="RoyalBase"]/apparelMoney</xpath>
          <value>
            <apparelMoney>2000~2500</apparelMoney>
          </value>
        </li>
        <!-- Set favor value for all Gemstones -->
        <li Class="PatchOperationAdd">
          <xpath>/Defs/ThingDef[defName="Diamond" or defName="Ruby" or defName="Sapphire"]/statBases</xpath>
          <value>
            <RoyalFavorValue>0.035</RoyalFavorValue>
          </value>
        </li>
        <!-- Update trader to accept Gemstones trade tag -->
        <li Class="PatchOperationAdd">
          <xpath>/Defs/TraderKindDef[defName="Empire_Caravan_TributeCollector"]/stockGenerators</xpath>
          <value>
            <li Class="StockGenerator_BuyTradeTag">
              <tag>Gemstones</tag>
            </li>
          </value>
        </li>
      </operations>
    </match>
  </Operation>
</Patch>